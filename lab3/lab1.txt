--Q1--
--M1--
SELECT NVL(COUNTRY,'GRAND TOTAL') AS COUNTRY,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2010,1,0) ) YEAR2010,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2011,1,0) ) YEAR2011,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2012,1,0) ) YEAR2012,
COUNT(ORDERID) TOTAL
FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMERID = ORDERS.CUSTOMERID
GROUP BY ROLLUP(COUNTRY);

--M2--
SELECT NVL(COUNTRY,'GRAND TOTAL') AS COUNTRY,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2010,1,0) ) YEAR2010,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2011,1,0) ) YEAR2011,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2012,1,0) ) YEAR2012,
COUNT(ORDERID) TOTAL
FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMERID = ORDERS.CUSTOMERID
GROUP BY GROUPING SETS(COUNTRY,());

--M3--
SELECT NVL(COUNTRY,'GRAND TOTAL') AS COUNTRY,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2010,1,0) ) YEAR2010,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2011,1,0) ) YEAR2011,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2012,1,0) ) YEAR2012,
COUNT(ORDERID) TOTAL
FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMERID = ORDERS.CUSTOMERID
GROUP BY COUNTRY
UNION ALL
SELECT 'GRANDTOTAL',
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2010,1,0) ) YEAR2010,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2011,1,0) ) YEAR2011,
SUM( DECODE (EXTRACT (YEAR FROM ORDERDATE),2012,1,0) ) YEAR2012,
COUNT(ORDERID) TOTAL
FROM ORDERS;

--Q2--
SELECT ORDERID,CUSTOMER.CUSTOMERID ||' '||COMPANYNAME AS "COMPANYINFO",SHIPCITY,SHIPDATE
FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMERID = ORDERS.CUSTOMERID

--Q3--
SELECT PRODUCTID||''||PRODUCTNAME AS "PRODUCTINFO",UNITPRICE
FROM PRODUCTS'
WHERE UNITPRICE >(
SELECT MAX(UNITPRICE)
FROM PRODUCTS JOIN CATEGORIES USING (CATEGORYID)
WHERE UPPER(CATEGORYNAME) = 'SEAFOOD' );

--Q4--
SELECT *
FROM (
SELECT SHIPCOUNTRY,RANK() OVER (ORDER BY COUNT (ORDERID) DESC) AS RNK
FROM ORDERS
GROUP BY SHIPCOUNTRY )
WHERE RNK<5;

--Q5--
SELECT 1 FROM DUAL
UNION ALL
....

SELECT ROWNUM
FROM DUAL 
CONNECT BY ROWNUM<=12;

SELECT EXTRACT(MONTH FROM ORDERDATE) MON,COUNT(ORDERID) ORDER#
FROM ORDERS 
WHERE EXTRACT(YEAR FROM ORDERDATE) = 2012
GROUP BY EXTRACT(MONTH FROM ORDERDATE);

SELECT A.MON,NVL(ORDER#,0) AS ORDER_NUM FROM (SELECT ROWNUM MON
FROM DUAL 
CONNECT BY ROWNUM<=12)
A LEFT OUTER JOIN (SELECT EXTRACT(MONTH FROM ORDERDATE) MON,COUNT(ORDERID) ORDER#
FROM ORDERS 
WHERE EXTRACT(YEAR FROM ORDERDATE) = 2012
GROUP BY EXTRACT(MONTH FROM ORDERDATE))
B ON A.MON = B.MON
ORDER BY A.MON;

--Q6--
COLUMN ModifiedAddress FORMAT A40;
COLUMN ModifiedAddress2 FORMAT A40;
COULMN ORIGNALADDRESS FORMAT A40;
SELECT REGEXp_REPLACE(REGEXp_REPLACE(ADDRESS,'-',''),'([0-9]+)(.*)','\1,\2') ModifiedAddress,
REGEXp_REPLACE(REGEXp_REPLACE(ADDRESS,'-',''),'([0-9]+)(.*)','\2,\1') ModifiedAddress2,
ADDRESS ORIGNALADDRESS
FROM (
SELECT *
FROM EMPLOYEES
MINUS
SELECT *
FROM EMPLOYEES
WHERE UPPER(ADDRESS) LIKE 'LONDON' );


OR UPPER(ADDRESS) <> 'LONDON'


--7--
SELECT CATEGORYNAME,PRODUCTID||' '||PRODUCTNAME AS "PRODUCTINFO",TO_CHAR(UNITPRICE,'$990.99') UNITPRICE,
RANK() OVER (PARTITION BY CATEGORYNAME ORDER BY UNITPRICE DESC) AS RANK
FROM CATEGORIES LEFT OUTER JOIN PRODUCTS USING (CATEGORYID)
WHERE UPPER(CATEGORYNAME) IN ('SEAFOOD','BEVERAGES');



















